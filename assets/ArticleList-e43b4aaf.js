import{g as le,a as ne,u as W,m as ce,T as ie,r as n,C as q,c as F,b as X,d as de,o as ue,i as ge,e as pe,f as me,W as he,R as B,j as a,I as _,F as v,S as K,B as P,h as Ce,k as w,l as k}from"./index-e3aeee9e.js";import{D as fe}from"./parser-62401535.js";import"./dayjs.min-a27ee3b3.js";import{u as be,p as M,F as ye,P as xe,D as Se}from"./index-a2b4bf63.js";import{S as je,a as Q}from"./iconUtil-f0efbcc9.js";import{P as ve}from"./PlusOutlined-3f2c3822.js";import{T as Ie}from"./Table-d8a4db81.js";const Te=e=>{const{paddingXXS:s,lineWidth:o,tagPaddingHorizontal:t,componentCls:r,calc:i}=e,c=i(t).sub(o).equal(),p=i(s).sub(o).equal();return{[r]:Object.assign(Object.assign({},ne(e)),{display:"inline-block",height:"auto",marginInlineEnd:e.marginXS,paddingInline:c,fontSize:e.tagFontSize,lineHeight:e.tagLineHeight,whiteSpace:"nowrap",background:e.defaultBg,border:`${W(e.lineWidth)} ${e.lineType} ${e.colorBorder}`,borderRadius:e.borderRadiusSM,opacity:1,transition:`all ${e.motionDurationMid}`,textAlign:"start",position:"relative",[`&${r}-rtl`]:{direction:"rtl"},"&, a, a:hover":{color:e.defaultColor},[`${r}-close-icon`]:{marginInlineStart:p,fontSize:e.tagIconSize,color:e.colorTextDescription,cursor:"pointer",transition:`all ${e.motionDurationMid}`,"&:hover":{color:e.colorTextHeading}},[`&${r}-has-color`]:{borderColor:"transparent",[`&, a, a:hover, ${e.iconCls}-close, ${e.iconCls}-close:hover`]:{color:e.colorTextLightSolid}},"&-checkable":{backgroundColor:"transparent",borderColor:"transparent",cursor:"pointer",[`&:not(${r}-checkable-checked):hover`]:{color:e.colorPrimary,backgroundColor:e.colorFillSecondary},"&:active, &-checked":{color:e.colorTextLightSolid},"&-checked":{backgroundColor:e.colorPrimary,"&:hover":{backgroundColor:e.colorPrimaryHover}},"&:active":{backgroundColor:e.colorPrimaryActive}},"&-hidden":{display:"none"},[`> ${e.iconCls} + span, > span + ${e.iconCls}`]:{marginInlineStart:c}}),[`${r}-borderless`]:{borderColor:"transparent",background:e.tagBorderlessBg}}},D=e=>{const{lineWidth:s,fontSizeIcon:o,calc:t}=e,r=e.fontSizeSM;return ce(e,{tagFontSize:r,tagLineHeight:W(t(e.lineHeightSM).mul(r).equal()),tagIconSize:t(o).sub(t(s).mul(2)).equal(),tagPaddingHorizontal:8,tagBorderlessBg:e.defaultBg})},A=e=>({defaultBg:new ie(e.colorFillQuaternary).onBackground(e.colorBgContainer).toHexString(),defaultColor:e.colorText}),U=le("Tag",e=>{const s=D(e);return Te(s)},A);var $e=globalThis&&globalThis.__rest||function(e,s){var o={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&s.indexOf(t)<0&&(o[t]=e[t]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,t=Object.getOwnPropertySymbols(e);r<t.length;r++)s.indexOf(t[r])<0&&Object.prototype.propertyIsEnumerable.call(e,t[r])&&(o[t[r]]=e[t[r]]);return o};const we=n.forwardRef((e,s)=>{const{prefixCls:o,style:t,className:r,checked:i,onChange:c,onClick:p}=e,m=$e(e,["prefixCls","style","className","checked","onChange","onClick"]),{getPrefixCls:d,tag:u}=n.useContext(q),x=T=>{c==null||c(!i),p==null||p(T)},C=d("tag",o),[I,b,l]=U(C),y=F(C,`${C}-checkable`,{[`${C}-checkable-checked`]:i},u==null?void 0:u.className,r,b,l);return I(n.createElement("span",Object.assign({},m,{ref:s,style:Object.assign(Object.assign({},t),u==null?void 0:u.style),className:y,onClick:x})))}),Oe=we,ke=e=>de(e,(s,o)=>{let{textColor:t,lightBorderColor:r,lightColor:i,darkColor:c}=o;return{[`${e.componentCls}${e.componentCls}-${s}`]:{color:t,background:i,borderColor:r,"&-inverse":{color:e.colorTextLightSolid,background:c,borderColor:c},[`&${e.componentCls}-borderless`]:{borderColor:"transparent"}}}}),Pe=X(["Tag","preset"],e=>{const s=D(e);return ke(s)},A);function Ee(e){return typeof e!="string"?e:e.charAt(0).toUpperCase()+e.slice(1)}const E=(e,s,o)=>{const t=Ee(o);return{[`${e.componentCls}${e.componentCls}-${s}`]:{color:e[`color${o}`],background:e[`color${t}Bg`],borderColor:e[`color${t}Border`],[`&${e.componentCls}-borderless`]:{borderColor:"transparent"}}}},Ne=X(["Tag","status"],e=>{const s=D(e);return[E(s,"success","Success"),E(s,"processing","Info"),E(s,"error","Error"),E(s,"warning","Warning")]},A);var ze=globalThis&&globalThis.__rest||function(e,s){var o={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&s.indexOf(t)<0&&(o[t]=e[t]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,t=Object.getOwnPropertySymbols(e);r<t.length;r++)s.indexOf(t[r])<0&&Object.prototype.propertyIsEnumerable.call(e,t[r])&&(o[t[r]]=e[t[r]]);return o};const Fe=(e,s)=>{const{prefixCls:o,className:t,rootClassName:r,style:i,children:c,icon:p,color:m,onClose:d,bordered:u=!0,visible:x}=e,C=ze(e,["prefixCls","className","rootClassName","style","children","icon","color","onClose","bordered","visible"]),{getPrefixCls:I,direction:b,tag:l}=n.useContext(q),[y,T]=n.useState(!0),N=ue(C,["closeIcon","closable"]);n.useEffect(()=>{x!==void 0&&T(x)},[x]);const g=ge(m),h=pe(m),S=g||h,j=Object.assign(Object.assign({backgroundColor:m&&!S?m:void 0},l==null?void 0:l.style),i),f=I("tag",o),[Y,Z,ee]=U(f),te=F(f,l==null?void 0:l.className,{[`${f}-${m}`]:S,[`${f}-has-color`]:m&&!S,[`${f}-hidden`]:!y,[`${f}-rtl`]:b==="rtl",[`${f}-borderless`]:!u},t,r,Z,ee),V=O=>{O.stopPropagation(),d==null||d(O),!O.defaultPrevented&&T(!1)},[,se]=be(M(e),M(l),{closable:!1,closeIconRender:O=>{const re=n.createElement("span",{className:`${f}-close-icon`,onClick:V},O);return me(O,re,$=>({onClick:L=>{var z;(z=$==null?void 0:$.onClick)===null||z===void 0||z.call($,L),V(L)},className:F($==null?void 0:$.className,`${f}-close-icon`)}))}}),ae=typeof C.onClick=="function"||c&&c.type==="a",R=p||null,oe=R?n.createElement(n.Fragment,null,R,c&&n.createElement("span",null,c)):c,H=n.createElement("span",Object.assign({},N,{ref:s,className:te,style:j}),oe,se,g&&n.createElement(Pe,{key:"preset",prefixCls:f}),h&&n.createElement(Ne,{key:"status",prefixCls:f}));return Y(ae?n.createElement(he,{component:"Tag"},H):H)},G=n.forwardRef(Fe);G.CheckableTag=Oe;const J=G;function Be({value:e=[],placeholder:s="",onChange:o}){const t=e||[],[r,i]=B.useState(""),c=d=>{d.preventDefault(),console.log(d.target.value),o([...new Set([...t,d.target.value])]),i("")},p=d=>{i(d.target.value)},m=d=>{o(t.filter(u=>u!==d))};return a.jsxs("div",{children:[a.jsx(_,{placeholder:s,value:r,onChange:p,onPressEnter:c}),a.jsx("div",{className:"mt-2",children:t.map(d=>a.jsx(J,{bordered:!1,closable:!0,color:"blue",onClose:u=>{m(u)},children:d},d))})]})}const _e={url:[{required:!0,message:"请输入文章链接"}]};function De({currentRow:e,onSuccess:s,onCancel:o,rootClassName:t}){n.useState([]),n.useState([]),n.useState([]);const[r,i]=B.useState(!1),[c,p]=B.useState([]),m={status:!0},[d]=v.useForm(),u=async()=>{i(!0);const l=await w.post("/getArticle",{articleId:e.articleId});l.ok&&d.setFieldsValue(l.data),i(!1)},x=async()=>{const l=await w.post("/getCategoryList",{});l.ok&&p(l.data.list.map(y=>({value:y.categoryId,label:y.title})))};n.useEffect(()=>{e&&e.articleId&&u(),x()},[]);const C=async l=>{(await w.post("/addArticle",l)).ok&&(k.success({content:"添加成功"}),s())},I=async l=>{(await w.post("/updateArticle",l)).ok&&(k.success({content:"更新成功"}),s())},b=async l=>{console.log("Success:",l),i(!0),e&&e.articleId?await I({...l,articleId:e.articleId}):await C({...l}),i(!1)};return a.jsxs(a.Fragment,{children:[a.jsxs(v,{form:d,rootClassName:t,name:"basic",labelCol:{span:4},initialValues:m,onFinish:b,autoComplete:"off",children:[a.jsx(v.Item,{label:"文章链接",name:"url",rules:_e.url,children:a.jsx(_,{placeholder:"文章链接"})}),a.jsx(v.Item,{label:"文章标题",name:"title",children:a.jsx(_,{placeholder:"文章标题"})}),a.jsx(v.Item,{label:"文章分类",name:"categoryId",children:a.jsx(je,{allowClear:!0,placeholder:"请选择文章分类",options:c})}),a.jsx(v.Item,{label:"文章标签",name:"tags",children:a.jsx(Be,{placeholder:"文章标签"})}),a.jsx(v.Item,{label:"状态",name:"status",valuePropName:"checked",children:a.jsx(Q,{})}),a.jsx(v.Item,{wrapperCol:{offset:8,span:16},children:a.jsxs(K,{children:[a.jsx(P,{onClick:o,children:"取消"}),a.jsx(P,{type:"primary",htmlType:"submit",children:"保存"})]})})]}),a.jsx(Ce,{spinning:r,fullscreen:!0})]})}const Ae=[{title:"文章标题",dataIndex:"title",key:"title",align:"center",render:(e,s)=>a.jsx("div",{className:"text-left",children:a.jsx("a",{href:s.url,target:"_blank",children:s.title||s.url})})},{title:"分类",dataIndex:"category",key:"category",align:"center",render:(e,s)=>{var o;return a.jsx(a.Fragment,{children:((o=s.category)==null?void 0:o.title)||"-"})}},{title:"标签",dataIndex:"title",key:"title",align:"center",render:(e,s)=>{const o=s.tags||[];return a.jsx("div",{className:"text-left",children:o&&o.length>0?o.map(t=>a.jsx(J,{bordered:!1,color:"blue",children:t},t)):"-"})}},{title:"状态",align:"center",dataIndex:"status",key:"status",width:100,render:(e,s)=>a.jsx(Q,{defaultChecked:s.status,onChange:o=>{s.handleStatusChange(s,o)}})},{title:"操作",align:"center",dataIndex:"taskId",key:"taskId",width:120,render:(e,s)=>a.jsxs(K,{size:"middle",children:[a.jsx(P,{type:"link",onClick:()=>{s.handleEditRow(s)},children:a.jsx(ye,{className:"cursor-pointer"})}),a.jsx(xe,{title:"确认删除",description:"",onConfirm:()=>{s.handleDeleteRow(s)},children:a.jsx(P,{danger:!0,type:"link",children:a.jsx(Se,{className:"cursor-pointer"})})})]})}],Xe=()=>{const[e,s]=n.useState([]),[o,t]=n.useState(!0),[r,i]=n.useState(null);k.useMessage();const[c,p]=n.useState({position:["bottomCenter"],total:0,current:1,pageSize:10}),m=async()=>{p(g=>{let h={...g,current:1};return C(h),h})},d=async(g,h)=>{t(!0),(await w.post("/updateArticleStatus",{articleId:g.articleId,status:h})).ok&&k.success({content:"操作成功"}),t(!1)},u=async g=>{i(g),b(!0)},x=async g=>{t(!0),(await w.post("/deleteArticle",{articleId:g.articleId})).ok&&(k.success({content:"操作成功"}),m()),t(!1)},C=async g=>{t(!0);const h=await w.post("/getArticlePage",{page:g.current,size:g.pageSize});if(h.ok){const S=h.data.list.map(j=>(j.handleStatusChange=d,j.handleEditRow=u,j.handleDeleteRow=x,j));s(S),p(j=>({...j,total:h.data.total}))}t(!1)},[I,b]=n.useState(!1),l=()=>{i(null),b(!0)},y=()=>{b(!1),m()},T=()=>{b(!1)},N=g=>{console.log(g),p(h=>{let S={...h,...g};return C(S),S})};return n.useEffect(()=>{C(c)},[]),a.jsxs(a.Fragment,{children:[a.jsx(P,{type:"primary",onClick:l,icon:a.jsx(ve,{}),children:"添加文章"}),a.jsx(Ie,{className:"mt-4",bordered:!0,rowKey:"articleId",loading:o,columns:Ae,dataSource:e,pagination:c,onChange:N}),a.jsx(fe,{title:r?"编辑文章":"添加文章",open:I,width:"600px",destroyOnClose:!0,onClose:T,children:a.jsx(De,{currentRow:r,onCancel:T,onSuccess:y})})]})};export{Xe as default};
